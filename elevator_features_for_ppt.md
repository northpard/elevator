# 엘리베이터 프로젝트 — 기능 요약

(이 파일은 Google Slides로 옮겨 프레젠테이션을 만들기 쉽도록 슬라이드별로 분리된 Markdown 형식으로 작성되었습니다.)

---

## 제목 슬라이드
- 프로젝트: Arduino 기반 3층 엘리베이터 시뮬레이터
- 작성자: northpard
- 날짜: 2025-11-14

---

## 개요
- 목적: 외부 호출 버튼과 LED로 동작하는 3층 엘리베이터 기본 동작을 구현
- 주요 요구사항: 짧은 누름으로 호출 등록, 긴 누름으로 취소, 취소 보호 시간, 같은-방향-우선 스케줄링

---

## 하드웨어 전제 및 핀 매핑
- 보드: Arduino Uno 가정
- 버튼: INPUT_PULLUP(액티브 LOW)
- 핀 매핑 요약:
  - 호출 버튼: D11(1층), D12(2층), D13(3층)
  - 버튼 LED: D8, D9, D10
  - 층 표시 LED: A0(1층), D4(2층), D7(3층)
  - 층간 애니메이션 LED: D2, D3, D5, D6

---

## 사용자 인터랙션(요청 및 취소)
- 짧게 누름: 해당 층 호출 등록 (요청 배열에 기록)
- 긴 누름(>= 1000ms): 이미 등록된 요청을 취소
- 취소 시 시각적 피드백: 버튼 LED 깜빡임
- 취소 보호시간: 취소 후 500ms 동안 재등록 방지
- 디바운스: 50ms

---

## 스케줄링 및 이동 정책
- 상태 머신 기반: 대기, 상승 중, 하강 중, 도착 처리 중
- 같은-방향 우선(일종의 SCAN 방식): 현재 이동 방향과 같은 방향의 호출을 먼저 처리
- 대기 상태일 때: 가장 가까운 호출(거리 최솟값) 선택, 동률 시 위쪽 우선
- 층간 이동은 비차단 애니메이션(두 단계)으로 표시

---

## 이동/도착 처리
- 층간 LED(4개)를 사용한 이동 애니메이션
- 도착 시 해당 층 LED를 켜고, 요청이 있으면 도어가 열려 있는 시간을 적용
- 도착 후 해당 층의 요청을 제거
- 도착 후 다음 이동은 동일 방향 우선 정책으로 결정

---

## 소프트웨어 아키텍처
- 논블로킹 설계: 시간 기준(밀리초)으로 모든 동작(입력, 깜빡임, 이동)을 비차단적으로 실행
- 요청과 버튼 LED 상태 동기화(요청-LED 동기화)
- 깜빡임 상태를 별도로 관리하는 상태머신(깜빡임 상태 갱신)
- 보조 판정: 현재층 위쪽/아래쪽에 대기 중인 호출이 있는지 판정

---

## 현재 미구현/제한 사항
- 캐빈 내부 버튼(실내 버튼): 미구현
- EEPROM/비휘발성 상태 저장: 미구현
- 부팅 시 핀 글리치 가능성: 업로드/리셋 직후 특정 환경에서 버튼 핀(11-13)이 LOW로 읽혀 자동 호출 등록이 발생할 수 있음
  - 권장 보완: 소프트웨어 초기화(부팅 안정화 검사) 또는 하드웨어 변경(다른 GPIO 사용, 외부 풀업/RC)

---

## 테스트 시나리오(권장)
- 짧은 누름 등록 테스트: 각 층 버튼을 짧게 눌러 LED 켜짐 및 이동 확인
- 긴 누름 취소 테스트: 호출된 상태에서 1초 이상 눌러 취소 및 깜빡임 확인
- 취소 보호 테스트: 취소 직후 500ms 내 재등록 불가 확인
- 같은-방향 우선 테스트: 여러 호출 등록 후 이동 경로가 같은 방향 우선으로 결정되는지 확인
- 부팅 글리치 테스트: 업로드/리셋 직후 핀 상태 관찰 및 자동 이동 발생 여부 확인

---

## 다음 단계(권장 개선)
- 부팅 안정화: setup()에서 버튼 핀 상태를 안정화(일정 시간 읽기 후 안정 시 등록 허용)하는 소프트웨어 패치
- 회로 개선: 버튼 입력 핀을 SPI(11-13)에서 다른 디지털 핀으로 이동하거나 외부 풀업/RC 필터 추가
- 기능 확장: 캐빈 내부 버튼, 층 표시 개선(7-seg 또는 LCD), 문 열림/닫힘 물리적 시뮬레이션
- 문서화: `SUBMISSION.md`에 변경 내용과 테스트 리포트 추가

---

## 메모(발표용 포인트)
- 비차단 설계로 다른 작업을 방해하지 않으면서 애니메이션/입력 처리를 수행함
- 긴 누름 취소 + 취소 보호 조합으로 오작동(글리치) 영향 최소화
- 부팅 글리치 사례는 하드웨어(핀) 특성과 업로드/리셋 타이밍 관련 — 실제 하드웨어에서 확인 필요

---

끝.
